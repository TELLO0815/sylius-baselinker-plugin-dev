<p align="center">
    <a href="https://spinbits.com" target="_blank">
        <img height="50" src="data:image/webp;base64,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" />
    </a>
</p>

<h1 align="center">Sylius Baselinker Plugin</h1>

## Help
If you need some help with Sylius development, don't hesitate to contact us directly. You can send us an email at office@spinbits.io

## Quickstart Installation

1. Run `composer require spinbits/sylius-baselinker-plugin`.

2. Import route into your routing file:

```
spinbits_baselinker_plugin:
    resource: "@SpinbitsSyliusBaselinkerPlugin/Resources/config/admin_routing.yml"
```

3. Import trait to your Order entity: `src/Entity/Order/Order.php`
```
use Spinbits\SyliusBaselinkerPlugin\Entity\Order\OrderTrait;

class Order extends BaseOrder
{
    use OrderTrait;

```

4. Register BaselinkerHandlers and passowrd: `config/services.yaml`
```
    Spinbits\BaselinkerSdk\RequestHandler:
        arguments:
            $password: '%env(BASELINKER_PASSWORD)%'
        calls:
            - method: registerHandler
              arguments:
                  - FileVersion
                  - '@Spinbits\SyliusBaselinkerPlugin\Handler\FileVersionActionHandler'
            - method: registerHandler
              arguments:
                  - OrderAdd
                  - '@Spinbits\SyliusBaselinkerPlugin\Handler\OrderAddActionHandler'
            - method: registerHandler
              arguments:
                  - ProductsPrices
                  - '@Spinbits\SyliusBaselinkerPlugin\Handler\ProductPricesActionHandler'
            - method: registerHandler
              arguments:
                  - ProductsQuantity
                  - '@Spinbits\SyliusBaselinkerPlugin\Handler\ProductQuantityActionHandler'
            - method: registerHandler
              arguments:
                  - ProductsCategories
                  - '@Spinbits\SyliusBaselinkerPlugin\Handler\ProductsCategoriesActionHandler'
            - method: registerHandler
              arguments:
                  - ProductsDetails
                  - '@Spinbits\SyliusBaselinkerPlugin\Handler\ProductsDetailsActionHandler'
            - method: registerHandler
              arguments:
                  - ProductsList
                  - '@Spinbits\SyliusBaselinkerPlugin\Handler\ProductsListActionHandler'
            - method: registerHandler
              arguments:
                  - StatusesList
                  - '@Spinbits\SyliusBaselinkerPlugin\Handler\StatusesListActionHandler'
            - method: registerHandler
              arguments:
                  - SupportedMethods
                  - '@Spinbits\BaselinkerSdk\Handler\Common\SupportedMethodsActionHandler'

```

5. Copy Migration file:
`cp vendor/spinbits/sylius-baselinker-plugin/src/Migrations/Version20211005090821.php ./src/Migrations/`

6. Run migrations:
`bin/console doctrine:migrations:migrate`

## Usage

### Running plugin tests

  - PHPUnit

    ```bash
    vendor/bin/phpunit
    ```

  - PHPSpec

    ```bash
    vendor/bin/phpspec run
    ```

  - Behat (non-JS scenarios)

    ```bash
    vendor/bin/behat --strict --tags="~@javascript"
    ```

  - Behat (JS scenarios)
 
    1. [Install Symfony CLI command](https://symfony.com/download).
 
    2. Start Headless Chrome:
    
      ```bash
      google-chrome-stable --enable-automation --disable-background-networking --no-default-browser-check --no-first-run --disable-popup-blocking --disable-default-apps --allow-insecure-localhost --disable-translate --disable-extensions --no-sandbox --enable-features=Metal --headless --remote-debugging-port=9222 --window-size=2880,1800 --proxy-server='direct://' --proxy-bypass-list='*' http://127.0.0.1
      ```
    
    3. Install SSL certificates (only once needed) and run test application's webserver on `127.0.0.1:8080`:
    
      ```bash
      symfony server:ca:install
      APP_ENV=test symfony server:start --port=8080 --dir=tests/Application/public --daemon
      ```
    
    4. Run Behat:
    
      ```bash
      vendor/bin/behat --strict --tags="@javascript"
      ```
    
  - Static Analysis
  
    - Psalm
    
      ```bash
      vendor/bin/psalm
      ```
      
    - PHPStan
    
      ```bash
      vendor/bin/phpstan analyse -c phpstan.neon -l max src/  
      ```

  - Coding Standard
  
    ```bash
    vendor/bin/ecs check src
    ```

### Opening Sylius with your plugin

- Using `test` environment:

    ```bash
    (cd tests/Application && APP_ENV=test bin/console sylius:fixtures:load)
    (cd tests/Application && APP_ENV=test bin/console server:run -d public)
    ```
    
- Using `dev` environment:

    ```bash
    (cd tests/Application && APP_ENV=dev bin/console sylius:fixtures:load)
    (cd tests/Application && APP_ENV=dev bin/console server:run -d public)
    ```
